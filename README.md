# Telegram-bot. <br/>Home work for UAI, lesson 15.


![alt-—Ç–µ–∫—Å—Ç](https://github.com/HeyArtem/dixy_scraping/blob/main/picture_dixy.png "–¢–µ–∫—Å—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞ –ª–æ–≥–æ—Ç–∏–ø–∞ 1")



## –¢–µ—Ö.–¥–µ—Ç–∞–ª–∏: 
* _aiogram_
* _async_
* _fsm_
* _ReplyKeyboardMarkup_
* _InlineKeyboardMarkup_
* _dp.message handler_
* _dp.callback query handler_
* _requests_
* _BeautifulSoup_
* _bs4_
* _os_
* _json_ 
* _time_
* _random_
<br/><br/>
<hr>

## –û–ø–∏—Å–∞–Ω–∏–µ:
–¢–µ–ª–µ–≥—Ä–∞–º –±–æ—Ç, –∏–º–∏—Ç–∏—Ä—É–µ—Ç –±–æ—Ç–∞ –¥–ª—è –∑–∞–∫–∞–∑–∞ –µ–¥—ã. 
<br/>- –ß–∞—Å—Ç—å –≤–µ—Ç–∫–∏ –ø–æ –∑–∞–∫–∞–∑—É –µ–¥—ã, —è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª –Ω–∞ –æ–±—ã—á–Ω—ã—Ö –∫–Ω–æ–ø–∫–∞—Ö, —á–∞—Å—Ç—å –Ω–∞ –ò–Ω–ª–∞–π–Ω –∫–ª–∞–≤–∏–∞—Ç—É—Ä–µ
<br/>- –ù–∞–ø–∏—Å–∞–ª –ú–∞—à–∏–Ω—É —Å–æ—Å—Ç–æ—è–Ω–∏–π (Finite-state machine). –ú–∏–Ω–∏ FSM (–¢–≤–æ–µ –ò–º—è, –ª—é–±–∏–º–æ–µ –∞–≤—Ç–æ, —Å—Ç–æ—Ä–æ–Ω–∞ —Å–≤–µ—Ç–∞) –∏ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è FSM —Å –≤—ã–≤–æ–¥–æ–º –∏—Ç–æ–≥–∞ –≤—Å–µ–≥–æ –∑–∞–∫–∞–∑–∞
<br/>- –ü–æ–¥–∫–ª—é—á–∏–ª —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –ø–∞—Ä—Å–∏—Ç –¥–∞–Ω–Ω—ã–µ —Å —Å–∞–π—Ç–∞ Dixy –∏ –≤—ã–≤–æ–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä (–ø–µ—Ä–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞)
<br/>- –ò–Ω–ª–∞–π–Ω –∫–Ω–æ–ø–∫–∏ —Å —Å—ã–ª–∫–∞–º–∏, –∫–Ω–æ–ø–∫–∞ –∑–∞–≥–ª—É—à–∫–∞
<br/><br/>
<hr>

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
–í –ø—Ä–æ–µ–∫—Ç–µ –ø—Ä–∏–º–µ–Ω—è–ª –æ—Ç–≤–µ—Ç —Å —Ü–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è, –≤—ã–≤–æ–¥ –∏–º–µ–Ω–∏ –∏ id –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –Ω–∞–ø–∏—Å–∞–ª —Ö—ç–Ω–¥–ª–µ—Ä—ã (—Ñ–∏–ª—å—Ç—Ä—ã –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏) –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å callback_query (–∏–Ω–ª–∞–π–Ω –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞), message_handler (–æ–±—ã—á–Ω—ã–µ –∫–Ω–æ–ø–∫–∏). –§–∏–ª—å—Ç—Ä—ã equals (—Ñ–∏–ª—å—Ç—Ä –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏) –∏ ignore_case, text, bold, italic. –ó–∞–ª–∏–≤–∞–ª —Å–ø–∏—Å–∫–∏ –≤ —Ö—ç–Ω–¥–ª–µ—Ä—ã.
<br/><br/>
<hr>

## –ß—Ç–æ –±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç:
- —Å–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ
- –æ—Ç–∫—Ä—ã—Ç—å –Ω—É–∂–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π-Code-HTTPS-—Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É
- $ git clone + —Å—Å—ã–ª–∫–∞
- –ø–µ—Ä–µ–π—Ç–∏ –≤ –ø–∞–∫—É —Å –ø—Ä–æ–µ–∫—Ç–æ–º
- $ python3 -m venv venv -—Å–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
- $ source venv/bin/activate -–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
- $ pip install -U pip setuptools
- $ pip install -r requirements.txt -—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏–∑ requirements.txt
- $ code . -–æ—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ–µ–∫—Ç –≤ VS Code
- –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω —Å–≤–æ–µ–≥–æ –±–æ—Ç–∞ (https://t.me/BotFather) (@BotFather)
- –í–ø–∏—Å–∞—Ç—å —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ (.env). 
- –∑–∞–ø—É—Å—Ç–∏—Ç—å app.py 
- –í–æ–∑–º–æ–∂–Ω–æ –ø–æ—Ç—Ä–µ–±—É—é—Ç—Å—è —Å–≤–µ–∂–∏–µ headers (dixy.py)
<br/><br/>
<hr>

## –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:
- –ü—Ä–∏ –≤—ã–≤–æ–¥–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–∞—Ä—Å–∏–Ω–≥–∞, —Å—Ç–æ–ª–∫–Ω—É–ª—Å—è —Å –ø—Ä–æ–±–ª–µ–º–æ–π, –Ω–µ–ª—å–∑—è —É–ø–∞–∫–æ–≤–∞—Ç—å –≤–µ—Å—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–∫—Ä–∞–ø–∏–Ω–≥–∞ –≤ –æ–¥–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Å–≤—è–∑–∏ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–∏–º–≤–æ–ª–æ–≤ (–¥–æ 4 096 —Å–∏–º–≤–æ–ª–æ–≤).  –í –±—É–¥—É—â–µ–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å –≤—ã–≤–æ–¥ –∏–ª–∏ –≤—ã–≥—Ä—É–∂–∞—Ç—å –≤ —Ñ–∞–∏–ª.
> aiogram.utils.exceptions.MessageIsTooLong: Message is too long
<br/>

- –í —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–æ–µ–∫—Ç–µ —É–ø–∞–∫–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –≥—Ä—É–ø–ø—ã —Ö—ç–Ω–¥–ª–µ—Ä–æ–≤ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏.  –ù–∞–ø—Ä–∏–º–µ—Ä: (üìÇ handlers/users/dir_for_eat), –∞ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ö—ç–Ω–¥–ª–µ—Ä—ã –≤ –¥—Ä—É–≥—É—é  (üìÇ handlers/users/dir_another).

- –ù–∞—É—á–∏—Ç—Å—è –ø—Ä–∏–≤—è–∑—ã–≤–∞—Ç—å –∫ –±–ª—é–¥—É —Å—Ç–æ–∏–º–æ—Å—Ç—å –∏ –Ω–∞–ø–∏—Å–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –∫–∞–ª—å–∫—É–ª—è—Ü–∏—é.
- –î–æ–±–∞–≤–∏—Ç—å –≤–µ—Ä–Ω—É—Ç—Å—è –Ω–∞–∑–∞–¥ –≤ –∫–∞–∂–¥–æ–º —Ä–∞–∑–¥–µ–ª–µ, —Å–æ–≤–º–µ—Å—Ç–∏—Ç—å —ç—Ç–æ —Å FSM (—á—Ç–æ –±—ã –ø–æ–∫—É–ø–∞—Ç–µ–ª—å –º–æ–≥ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –±–ª—é–¥–∞ –∏–∑ —Ä–∞–∑–Ω—ã—Ö —Ä–∞–∑–¥–µ–ª–æ–≤).
- –°–¥–µ–ª–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ–≤—Ä–∞, +1 –∏–ª–∏ -1.
- –°–¥–µ–ª–∞—Ç—å –∫–æ—Ä–∑–∏–Ω—É, –ø—Ä–æ—Å–º–æ—Ç—Ä –∫–æ—Ä–∑–∏–Ω—ã (–ø–æ–∫–∞–∑–∞–Ω–æ 3 –∏–∑ 9), –æ—Ñ–æ—Ä–º–∏—Ç—å.
- –ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Ä–∞–∑–¥–µ–ª –∏–∑–±—Ä–∞–Ω–Ω–æ–µ.
- –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫–∏
- –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ —Å–ø–æ—Å–æ–±—ã —Ä–∞–±–æ—Ç—ã —Å FSM:
```python 
#option 1
await state.update_data(answer1=answer)

# option 2
await state.update(
{'answer1':answer}
)
# option 3  –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä, —É–¥–æ–±–Ω–æ, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –¥–æ—Å—Ç–∞–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ –∏–∑–º–µ–Ω—è—Ç—å
async with state.proxy()as data:
        data['answer1'] = answer

–Ω–∞–ø—Ä–∏–º–µ—Ä:
async with state.proxy()as data:
        data['some_list'].append(1)

# —Ç–æ–∂–µ —Å–∞–º–æ–µ, —á—Ç–æ –∏
data = await state.get_data()
some_list = data.get("some_list')
some_list.append(1)
await state.update_data(some_list=some_list)
```
